<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Transition — Mesh → Wooden Ceiling</title>
<link rel="stylesheet" href="transition.css?v=18">
</head><body>
<a href="index.html" class="back-button">← Back</a>
<div class="transition-label" aria-hidden="true">Moving from Mesh to Wooden Ceiling</div>
<main class="stage" aria-label="Transition video from Mesh to Wooden Ceiling">
  <video id="vid" src="mesh-ceiling.mp4" autoplay playsinline muted preload="auto"></video>
  <div id="loader" class="loader" role="status" aria-live="polite"><div class="spinner" aria-hidden="true"></div><span class="visually-hidden">Loading video…</span></div>
  <button id="skip" class="skip" type="button">Skip</button><div id="fade" class="fade" aria-hidden="true"></div>
</main>
<script>
  const params = new URLSearchParams(location.search);
  const isFinal = params.has('final');
  const DEST = isFinal ? 'ceiling.html?final=1' : 'ceiling.html?next=fabric';

  const vid = document.getElementById('vid');
  const skip = document.getElementById('skip');
  const fade = document.getElementById('fade');

  setTimeout(()=> skip.classList.add('show'), 2500);
  const go = () => { fade.classList.add('in'); setTimeout(()=>location.href = DEST, 250); };

  const loader = document.getElementById('loader');
  const hideLoader = () => loader.classList.add('hidden');
  vid.addEventListener('canplaythrough', hideLoader, { once:true });
  vid.addEventListener('playing', hideLoader, { once:true });
  setTimeout(hideLoader, 4000);

  vid.addEventListener('ended', go);
  skip.addEventListener('click', go);
  vid.addEventListener('error', () => { hideLoader(); skip.classList.add('show'); });
</script>
</body></html>
